<div class="product-form-container">
  <div class="header">
    <h1>{{ isEditMode() ? 'Edit Product' : 'Add New Product' }}</h1>
    <a routerLink="/products" class="btn btn-secondary">Back to List</a>
  </div>

  @if (error()) {
    <div class="error-message">
      {{ error() }}
    </div>
  }

  @if (loading() && isEditMode()) {
    <div class="loading">Loading product...</div>
  } @else {
    <form [formGroup]="productForm" (ngSubmit)="onSubmit()" class="product-form">
      <div class="form-group">
        <label for="name">Name <span class="required">*</span></label>
        <input
          type="text"
          id="name"
          formControlName="name"
          class="form-control"
          [class.invalid]="isFieldInvalid('name')"
          placeholder="Enter product name"
        />
        @if (isFieldInvalid('name')) {
          <span class="error-text">{{ getFieldError('name') }}</span>
        }
      </div>

      <div class="form-group">
        <label for="sku">SKU <span class="required">*</span></label>
        <input
          type="text"
          id="sku"
          formControlName="sku"
          class="form-control"
          [class.invalid]="isFieldInvalid('sku')"
          placeholder="Enter product SKU"
          [readonly]="isEditMode()"
        />
        @if (isFieldInvalid('sku')) {
          <span class="error-text">{{ getFieldError('sku') }}</span>
        }
        @if (isEditMode()) {
          <small class="hint">SKU cannot be changed in edit mode</small>
        }
      </div>

      <div class="form-group">
        <label for="description">Description</label>
        <textarea
          id="description"
          formControlName="description"
          class="form-control"
          rows="4"
          placeholder="Enter product description (optional)"
        ></textarea>
      </div>

      <div class="form-group">
        <label for="price">Price <span class="required">*</span></label>
        <input
          type="number"
          id="price"
          formControlName="price"
          class="form-control"
          [class.invalid]="isFieldInvalid('price')"
          placeholder="0.00"
          step="0.01"
          min="0.01"
        />
        @if (isFieldInvalid('price')) {
          <span class="error-text">{{ getFieldError('price') }}</span>
        }
      </div>

      <div class="form-actions">
        <button
          type="submit"
          [disabled]="productForm.invalid || loading()"
          class="btn btn-primary"
        >
          {{ loading() ? 'Saving...' : (isEditMode() ? 'Update Product' : 'Create Product') }}
        </button>
        <a
          routerLink="/products"
          class="btn btn-secondary"
          [class.disabled]="loading()"
        >
          Cancel
        </a>
      </div>
    </form>
  }
</div>

